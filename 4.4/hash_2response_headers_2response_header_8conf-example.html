<!-- HTML header for doxygen 1.8.15-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.15"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>51Degrees Device Detection Nginx: hash/responseHeaders/responseHeader.conf</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="examplegrabber.js"></script>
<script type="text/javascript" src="testedversionsgrabber.js"></script>
<script type="text/javascript" src="search51.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(initResizable);
/* @license-end */</script>
<link href="docs-main.min.css" rel="stylesheet" type="text/css" />
</head>
<body class="l-docs-index p-doxygen">
<div class="l-index__content">
<!--div id="top"--><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea" class="g-header g-header--docs">
  <h1 class="c-brand">
  <a id="projectlogo" href="../../documentation/4.4/index.html" class="c-brand__link"><img class="c-brand__image" alt="Logo" src="logo-51Degrees-Docs.png" style="width:172px;"/></a>
  <span class="c-tagline">51Degrees Device Detection Nginx
   &#160;<span id="projectnumber">4.4</span>
  </span>
  </h1>
  <div id="projectalign" style="padding-left: 0.5em;">
   <div id="projectbrief">A device detection module for Nginx</div>
  </div>
  <div id="main-nav"></div>
  <section class="g-search">
    <div class="c-search is-openable" id="searchOpenable">
    <form class="c-search__form">
      <div class="b-form-group b-form-group--with-icon">
        <label for="inputSearch" class="b-text--hidden">Search</label>
        <img src="icon-search.svg" class="b-icon" alt="Search" />
        <input type="text" class="c-search__input" id="inputSearch" onkeyup="javascript:onSearch(this,event.keyCode)" placeholder="Search" aria-label="Search">
      </div>
    </form>
    <div class="c-search__content" id="searchContent">
    </div>
  </div> 
  </section>
</div>
<!-- end header part -->
<main class="g-main">
<!-- Generated by Doxygen 1.8.15 -->
<!-- top -->
	<div class="g-docs__sidenav">																														         <nav id="nav-tree-contents" class="c-sidenav">																														     <h4 class="c-sidenav__heading">Documentation</h4>																									         <div id="nav-sync" class="sync"></div>
  <ul class="c-sidenav__list">																														     </ul>																																				   </nav>    </div><script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('hash_2response_headers_2response_header_8conf-example.html','');});
/* @license-end */
</script>
<div id="doc-content" class="g-docs__content">
<div class="g-docs__header">
<h2 class="g-docs__page-title">hash/responseHeaders/responseHeader.conf</h2></div><!--header-->
<div class="g-docs__inner">
<div class="g-docs__primary" id="primary">
<p>This example shows how to obtain response header for 51Degrees' on-premise device detection in Nginx when Client Hints is enabled. This example is available in full on <a href="https://github.com/51Degrees/device-detection-nginx/blob/master/examples/hash/responseHeader.conf">GitHub</a>.</p>
<p>
<p>
This example requires a local data file. The free 'Lite' data file can be acquired by
pulling the git submodules under this repository (run `git submodule update --recursive`) 
or from the <a href="https://github.com/51Degrees/device-detection-data">device-detection-data</a>
GitHub repository.
</p>
<p>
The Lite data file is only used for illustration, and has limited accuracy and capabilities.
Find out about the more capable data files that are available on our 
<a href="https://51degrees.com/pricing">pricing page</a>
</p>
</p>
<p>Make sure to include the 'BrowserName','BrowserVendor', 'BrowserVersion','HardwareName','HardwareVendor', 'PlatformName','PlatformVendor','PlatformVersion' properties.</p>
<p>Before using the example, update the followings:</p><ul>
<li>Remove this 'how to' guide block.</li>
<li>Update the %%DAEMON_MODE%% to 'on' or 'off'.</li>
<li>Remove the %%TEST_GLOBALS%%.</li>
<li>Update the %%MODULE_PATH%% with the actual path.</li>
<li>Remove the %%TEST_GLOBALS_HTTP%%.</li>
<li>Update the %%FILE_PATH%% with the actual file path.</li>
<li>Replace the nginx.conf with this file or run Nginx with <code>-c</code> option pointing to this file.</li>
<li>Added the included response.html to the Nginx <code>document_root</code>.</li>
</ul>
<p>Once Nginx has started, run the following command: </p><div class="c-code__block c-code__block--outline"><div class="c-code__line">curl -H <span class="c-code__stringliteral">&quot;sec-ch-ua: \&quot; Not A;Brand\&quot;;v=\&quot;99\&quot;, \&quot;Chromium\&quot;;v=\&quot;90\&quot;, \&quot;Google Chrome\&quot;;v=\&quot;90\&quot;&quot;</span> http:<span class="c-code__comment">//localhost:8080/response.html</span></div></div><p> Expected output: </p><div class="c-code__block c-code__block--outline"><div class="c-code__line">...</div><div class="c-code__line">&lt;strong&gt;Hardware Vendor: &lt;/strong&gt; Unknown</div><div class="c-code__line">&lt;br /&gt;</div><div class="c-code__line">&lt;strong&gt;Hardware Name: &lt;/strong&gt; Desktop|Emulator</div><div class="c-code__line">&lt;br /&gt;</div><div class="c-code__line">&lt;strong&gt;Device Type: &lt;/strong&gt; Desktop</div><div class="c-code__line">&lt;br /&gt;</div><div class="c-code__line">&lt;strong&gt;Platform Vendor: &lt;/strong&gt; Unknown</div><div class="c-code__line">&lt;br /&gt;</div><div class="c-code__line">&lt;strong&gt;Platform Name: &lt;/strong&gt; Unknown</div><div class="c-code__line">&lt;br /&gt;</div><div class="c-code__line">&lt;strong&gt;Platform Version: &lt;/strong&gt; Unknown</div><div class="c-code__line">&lt;br /&gt;</div><div class="c-code__line">&lt;strong&gt;Browser Vendor: &lt;/strong&gt; Google</div><div class="c-code__line">&lt;br /&gt;</div><div class="c-code__line">&lt;strong&gt;Browser Name: &lt;/strong&gt; Chrome</div><div class="c-code__line">&lt;br /&gt;</div><div class="c-code__line">&lt;strong&gt;Browser Version: &lt;/strong&gt; 90</div><div class="c-code__line">...</div></div><p> This shows that 51Degrees module can perform detection on Client Hints without User-Agent. <br />
</p>
<p>Run the command again with <code>-I</code> flag: </p><div class="c-code__block c-code__block--outline"><div class="c-code__line">curl -H <span class="c-code__stringliteral">&quot;sec-ch-ua: \&quot; Not A;Brand\&quot;;v=\&quot;99\&quot;, \&quot;Chromium\&quot;;v=\&quot;90\&quot;, \&quot;Google Chrome\&quot;;v=\&quot;90\&quot;&quot;</span> http:<span class="c-code__comment">//localhost:8080/response.html -I</span></div></div><p> Expected output: </p><div class="c-code__block c-code__block--outline"><div class="c-code__line">Accept-CH: SEC-CH-UA,SEC-CH-UA-Full-Version,SEC-CH-UA-Model,SEC-CH-UA-Mobile,SEC-CH-UA-Arch,SEC-CH-UA-Platform,SEC-CH-UA-Platform-Version</div></div><p> This shows that after a detection, 51Degrees module will construct response headers, indicating the Client Hints that it needs in order to perform more detection where is applicable..</p>
<p>User agents that support Client Hints will process the response headers and send further Client Hints in the subsequent requests. With further Client Hints, 51Degrees module will be able to detect more properties of the sending device. <br />
</p>
<p>User can also open the following url in a browser that supports Client Hints and follows the displayed instructions.</p>
<div class="c-code__block c-code__block--outline"><div class="c-code__line">http:<span class="c-code__comment">//localhost:8080/response.html</span></div></div><p><code>NOTE</code>: All the lines above, this line and the end of comment block line after this line should be removed before using this example.</p>
<div class="c-code__block c-code__block--outline"><div class="c-code__line"></div><div class="c-code__line"><span class="c-code__preprocessor">## Update DAEMON_NODE to &#39;on&#39; or &#39;off&#39; before running with Nginx ##</span></div><div class="c-code__line">daemon %%DAEMON_MODE%%;</div><div class="c-code__line">worker_processes 4;</div><div class="c-code__line"></div><div class="c-code__line"><span class="c-code__preprocessor">## The following line is only for testing. Remove before ##</span></div><div class="c-code__line"><span class="c-code__preprocessor">## running with Nginx ##</span></div><div class="c-code__line">%%TEST_GLOBALS%%</div><div class="c-code__line"><span class="c-code__preprocessor">## Update MODULE_PATH before running with Nginx ##</span></div><div class="c-code__line">load_module %%MODULE_PATH%%modules/<a name="a0"></a><a class="code" href="group__ngx__http__51_d__module.html#gaf47a09e4928fb9f32a16e2c71386b859">ngx_http_51D_module</a>.so;</div><div class="c-code__line"></div><div class="c-code__line">events {</div><div class="c-code__line">    worker_connections 1024;</div><div class="c-code__line">}</div><div class="c-code__line"></div><div class="c-code__line"><span class="c-code__preprocessor"># // Snippet Start</span></div><div class="c-code__line">http {</div><div class="c-code__line"><span class="c-code__preprocessor">    ## The following line is only for testing. Remove before ##</span></div><div class="c-code__line"><span class="c-code__preprocessor">    ## running with Nginx ##</span></div><div class="c-code__line">    %%TEST_GLOBALS_HTTP%%</div><div class="c-code__line"><span class="c-code__preprocessor">    ## Set the data file for the 51Degrees module to use ##</span></div><div class="c-code__line"><span class="c-code__preprocessor">    ## Update the FILE_PATH before running with Nginx ##</span></div><div class="c-code__line">    51D_file_path %%FILE_PATH%%;</div><div class="c-code__line"></div><div class="c-code__line">    server {</div><div class="c-code__line">        listen 127.0.0.1:8080;</div><div class="c-code__line">        server_name localhost;</div><div class="c-code__line"></div><div class="c-code__line">        location /response.html {</div><div class="c-code__line"><span class="c-code__preprocessor">            # Enable the response headers to be set for Client-Hints support.</span></div><div class="c-code__line">            51D_set_resp_headers on;</div><div class="c-code__line"></div><div class="c-code__line"><span class="c-code__preprocessor">            # Request browserVersion and IsMobile</span></div><div class="c-code__line">            51D_match_all x-hardwarevendor HardwareVendor;</div><div class="c-code__line">            51D_match_all x-hardwarename HardwareName;</div><div class="c-code__line">            51D_match_all x-devicetype DeviceType;</div><div class="c-code__line">            51D_match_all x-platformvendor PlatformVendor;</div><div class="c-code__line">            51D_match_all x-platformname PlatformName;</div><div class="c-code__line">            51D_match_all x-platformversion PlatformVersion;</div><div class="c-code__line">            51D_match_all x-browservendor BrowserVendor;</div><div class="c-code__line">            51D_match_all x-browsername BrowserName;</div><div class="c-code__line">            51D_match_all x-browserversion BrowserVersion;</div><div class="c-code__line"></div><div class="c-code__line"><span class="c-code__preprocessor">            # Replace the content in returned html with found one.</span></div><div class="c-code__line">            sub_filter <span class="c-code__stringliteral">&#39;HardwareVendor&#39;</span> $http_x_hardwarevendor;</div><div class="c-code__line">            sub_filter <span class="c-code__stringliteral">&#39;HardwareName&#39;</span> $http_x_hardwarename;</div><div class="c-code__line">            sub_filter <span class="c-code__stringliteral">&#39;DeviceType&#39;</span> $http_x_devicetype;</div><div class="c-code__line">            sub_filter <span class="c-code__stringliteral">&#39;PlatformVendor&#39;</span> $http_x_platformvendor;</div><div class="c-code__line">            sub_filter <span class="c-code__stringliteral">&#39;PlatformName&#39;</span> $http_x_platformname;</div><div class="c-code__line">            sub_filter <span class="c-code__stringliteral">&#39;PlatformVersion&#39;</span> $http_x_platformversion;</div><div class="c-code__line">            sub_filter <span class="c-code__stringliteral">&#39;BrowserVendor&#39;</span> $http_x_browservendor;</div><div class="c-code__line">            sub_filter <span class="c-code__stringliteral">&#39;BrowserName&#39;</span> $http_x_browsername;</div><div class="c-code__line">            sub_filter <span class="c-code__stringliteral">&#39;BrowserVersion&#39;</span> $http_x_browserversion;</div><div class="c-code__line">        }</div><div class="c-code__line">    }</div><div class="c-code__line">}</div><div class="c-code__line"><span class="c-code__preprocessor"># // Snippet End</span></div></div> </div><!-- primary -->
</div><!-- inner-->
<!-- HTML footer for doxygen 1.8.15-->
<!-- start footer part -->
<section id="nav-path" class="g-footer g-footer--docs"><!-- id is needed for treeview function! -->
    <p class="g-footer__copyright">Generated by
    <a href="http://www.doxygen.org/index.html">
    <b>doxygen</b></a> 1.8.15
  </p>
</section>
</div>
</main>
</div>
</body>
</html>
